"use strict";(self["webpackChunkpr_spacialization"]=self["webpackChunkpr_spacialization"]||[]).push([[537],{607:(o,t,i)=>{i.d(t,{Z:()=>m});i(71);var e=i(3673),n=i(2323);const a={id:"app"},s=(0,e.Uk)(" Let us locate you for better results... "),r={key:0},l={key:1},c=(0,e._)("i",null,"Getting your location...",-1),d=[c],u={key:2};function h(o,t,i,c,h,p){return(0,e.wg)(),(0,e.iD)("div",a,[(0,e._)("p",null,[s,(0,e._)("button",{onClick:t[0]||(t[0]=(...o)=>p.locateMe&&p.locateMe(...o))},"Get location")]),o.errorStr?((0,e.wg)(),(0,e.iD)("div",r," Sorry, but the following error occurred: "+(0,n.zw)(o.errorStr),1)):(0,e.kq)("",!0),o.gettingLocation?((0,e.wg)(),(0,e.iD)("div",l,d)):(0,e.kq)("",!0),o.location?((0,e.wg)(),(0,e.iD)("div",u," Your location data is "+(0,n.zw)(o.location.coords.latitude)+", "+(0,n.zw)(o.location.coords.longitude),1)):(0,e.kq)("",!0)])}i(6701);const p={name:"Localisation",data:function(){return{location:null,orientation:null,gettingLocation:!1,errorStr:null}},mounted:()=>{console.log("huhuhuhu")},computed:{dispOrientation(){return this.orientation}},methods:{async getLocation(){return new Promise(((o,t)=>{"geolocation"in navigator||t(new Error("Geolocation is not available.")),navigator.geolocation.getCurrentPosition((t=>{o(t)}),(o=>{t(o)}))}))},async getOrientation(){if(!window.DeviceOrientationEvent)throw console.log("Orientation not available"),new Error("Orientation not available on this device");window.addEventListener("deviceorientation",(o=>{console.log("z : "+o.alpha+"\n x : "+o.beta+"\n y : "+o.gamma+"\n abs"+o.absolute),this.orientation=Math.random()}))},async locateMe(){this.gettingLocation=!0;try{this.gettingLocation=!1,this.location=await this.getLocation()}catch(o){this.gettingLocation=!1,this.errorStr=o.message}},async orientateMe(){try{this.orientation=await this.getOrientation(),console.log(this.orientation)}catch(o){this.errorStr=o.message}}}};var w=i(4260);const g=(0,w.Z)(p,[["render",h]]),m=g},2537:(o,t,i)=>{i.r(t),i.d(t,{default:()=>fo});var e=i(3673);const n={class:"boombox-body"},a={class:"bb-front"},s=(0,e._)("section",{class:"master-controls"},[(0,e._)("input",{type:"range",id:"volume",class:"control-volume",min:"0",max:"2",value:"1",list:"gain-vals",step:"0.01","data-action":"volume"}),(0,e._)("datalist",{id:"gain-vals"},[(0,e._)("option",{value:"0",label:"min"}),(0,e._)("option",{value:"2",label:"max"})]),(0,e._)("label",{for:"volume"},"VOL")],-1),r={class:"tape"},l={ref:"audioPlayer",src:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/858/outfoxing.mp3",crossorigin:"anonymous"},c=(0,e._)("span",null,"Play/Pause",-1),d=(0,e._)("div",{class:"bb-top"},null,-1),u=(0,e._)("div",{class:"bb-right"},null,-1),h=(0,e._)("div",{class:"bb-bottom"},null,-1),p=(0,e._)("div",{class:"bb-left"},null,-1),w=(0,e._)("div",{class:"bb-back"},null,-1),g=(0,e._)("div",{id:"show position","aria-labelledby":"move-boombox"},null,-1),m={id:"position-controls","aria-labelledby":"get-position-boombox"},b=(0,e._)("h3",{id:"get-position-boombox"},"Get Position",-1),k={class:"get-position_xy"},v={class:"row q-col-gutter-sm"},L={class:"column"},f={class:"column"},_={class:"column"},M={id:"move-listener",class:"row q-col-gutter-sm"},S={class:"column"},Z={class:"column"},X={class:"column"},Y={id:"move-controls","aria-labelledby":"move-boombox"},R=(0,e._)("h3",{id:"move-boombox"},"Move Boombox",-1),x={class:"row q-col-gutter-sm"},C={class:"column"},P=(0,e._)("span",null,"Left",-1),y=(0,e._)("span",null,"Right",-1),B={class:"column"},W=(0,e._)("span",null,"Up",-1),V=(0,e._)("span",null,"Down",-1),q={class:"column"},D=(0,e._)("span",null,"Backward",-1),G=(0,e._)("span",null,"Forward",-1),O={class:"row q-col-gutter-sm"},A={id:"rotate-source"},I=(0,e._)("h3",null,"Rotate Source",-1),U={class:"row q-col-gutter-sm"},z={class:"column"},E=(0,e._)("span",null,"Clockwise X",-1),F=(0,e._)("span",null,"Anticlockwise X",-1),Q={class:"column"},$=(0,e._)("span",null,"Clockwise Y",-1),H=(0,e._)("span",null,"Anticlockwise Y",-1),K={class:"column"},N=(0,e._)("span",null,"Clockwise Z",-1),j=(0,e._)("span",null,"Anticlockwise Z",-1),T={id:"rotate-Listener"},J=(0,e._)("h3",null,"Rotate Listener",-1),oo={class:"row q-col-gutter-sm"},to={class:"column"},io=(0,e._)("span",null,"Clockwise X",-1),eo=(0,e._)("span",null,"Anticlockwise X",-1),no={class:"column"},ao=(0,e._)("span",null,"Clockwise Y",-1),so=(0,e._)("span",null,"Anticlockwise Y",-1),ro={class:"column"},lo=(0,e._)("span",null,"Clockwise Z",-1),co=(0,e._)("span",null,"Anticlockwise Z",-1);function uo(o,t,i,uo,ho,po){const wo=(0,e.up)("q-btn"),go=(0,e.up)("q-input"),mo=(0,e.up)("q-page");return(0,e.wg)(),(0,e.j4)(mo,null,{default:(0,e.w5)((()=>[(0,e._)("div",n,[(0,e._)("div",a,[s,(0,e._)("section",r,[(0,e._)("audio",l,null,512),(0,e.Wm)(wo,{onClick:t[0]||(t[0]=o=>po.playMusic()),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[c])),_:1})])]),d,u,h,p,w]),g,(0,e._)("div",m,[b,(0,e._)("section",k,[(0,e._)("div",v,[(0,e._)("div",L,[(0,e.Wm)(go,{standout:"",modelValue:ho.pannerSettings.positionX,"onUpdate:modelValue":t[1]||(t[1]=o=>ho.pannerSettings.positionX=o),onChange:t[2]||(t[2]=o=>po.updatePanner("X",ho.pannerSettings.positionX)),label:"Source X Position"},null,8,["modelValue"])]),(0,e._)("div",f,[(0,e.Wm)(go,{standout:"",modelValue:ho.pannerSettings.positionY,"onUpdate:modelValue":t[3]||(t[3]=o=>ho.pannerSettings.positionY=o),onChange:t[4]||(t[4]=o=>po.updatePanner("Y",ho.pannerSettings.positionY)),label:"Source Y Position"},null,8,["modelValue"])]),(0,e._)("div",_,[(0,e.Wm)(go,{standout:"",modelValue:ho.pannerSettings.positionZ,"onUpdate:modelValue":t[5]||(t[5]=o=>ho.pannerSettings.positionZ=o),onChange:t[6]||(t[6]=o=>po.updatePanner("Z",ho.pannerSettings.positionZ)),label:"Source Z Position"},null,8,["modelValue"])])]),(0,e._)("div",M,[(0,e._)("div",S,[(0,e.Wm)(go,{standout:"",modelValue:ho.positionListener.X,"onUpdate:modelValue":t[7]||(t[7]=o=>ho.positionListener.X=o),onChange:t[8]||(t[8]=o=>po.updateListener("X",ho.positionListener.X)),label:"Listener X Position"},null,8,["modelValue"])]),(0,e._)("div",Z,[(0,e.Wm)(go,{standout:"",modelValue:ho.positionListener.Y,"onUpdate:modelValue":t[9]||(t[9]=o=>ho.positionListener.Y=o),onChange:t[10]||(t[10]=o=>po.updateListener("Y",ho.positionListener.Y)),label:"Listener Y Position"},null,8,["modelValue"])]),(0,e._)("div",X,[(0,e.Wm)(go,{standout:"",modelValue:ho.positionListener.Z,"onUpdate:modelValue":t[11]||(t[11]=o=>ho.positionListener.Z=o),onChange:t[12]||(t[12]=o=>po.updateListener("Z",ho.positionListener.Z)),label:"Listener Z Position"},null,8,["modelValue"])])])])]),(0,e._)("div",Y,[R,(0,e._)("div",x,[(0,e._)("div",C,[(0,e.Wm)(wo,{onClick:t[13]||(t[13]=o=>po.moveBoombox("left")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[P])),_:1}),(0,e.Wm)(wo,{onClick:t[14]||(t[14]=o=>po.moveBoombox("right")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[y])),_:1})]),(0,e._)("div",B,[(0,e.Wm)(wo,{onClick:t[15]||(t[15]=o=>po.moveBoombox("up")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[W])),_:1}),(0,e.Wm)(wo,{onClick:t[16]||(t[16]=o=>po.moveBoombox("down")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[V])),_:1})]),(0,e._)("div",q,[(0,e.Wm)(wo,{onClick:t[17]||(t[17]=o=>po.moveBoombox("backward")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[D])),_:1}),(0,e.Wm)(wo,{onClick:t[18]||(t[18]=o=>po.moveBoombox("forward")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[G])),_:1})])])]),(0,e._)("div",O,[(0,e._)("div",A,[I,(0,e._)("div",U,[(0,e._)("div",z,[(0,e.Wm)(wo,{onClick:t[19]||(t[19]=o=>po.rotateSourceX("clockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[E])),_:1}),(0,e.Wm)(wo,{onClick:t[20]||(t[20]=o=>po.rotateSourceX("anticlockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[F])),_:1})]),(0,e._)("div",Q,[(0,e.Wm)(wo,{onClick:t[21]||(t[21]=o=>po.rotateSourceY("clockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[$])),_:1}),(0,e.Wm)(wo,{onClick:t[22]||(t[22]=o=>po.rotateSourceY("anticlockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[H])),_:1})]),(0,e._)("div",K,[(0,e.Wm)(wo,{onClick:t[23]||(t[23]=o=>po.rotateSourceZ("clockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[N])),_:1}),(0,e.Wm)(wo,{onClick:t[24]||(t[24]=o=>po.rotateSourceX("anticlockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[j])),_:1})])])]),(0,e._)("div",T,[J,(0,e._)("div",oo,[(0,e._)("div",to,[(0,e.Wm)(wo,{onClick:t[25]||(t[25]=o=>po.rotateListenerX("clockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[io])),_:1}),(0,e.Wm)(wo,{onClick:t[26]||(t[26]=o=>po.rotateListenerX("anticlockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[eo])),_:1})]),(0,e._)("div",no,[(0,e.Wm)(wo,{onClick:t[27]||(t[27]=o=>po.rotateListenerY("clockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[ao])),_:1}),(0,e.Wm)(wo,{onClick:t[28]||(t[28]=o=>po.rotateListenerY("anticlockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[so])),_:1})]),(0,e._)("div",ro,[(0,e.Wm)(wo,{onClick:t[29]||(t[29]=o=>po.rotateListenerZ("clockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[lo])),_:1}),(0,e.Wm)(wo,{onClick:t[30]||(t[30]=o=>po.rotateListenerZ("anticlockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[co])),_:1})])])])])])),_:1})}i(607);const ho={name:"Boombox",data(){return{localisationCtx:null,audioCtx:null,listener:null,track:null,gainNode:null,gpsListenerLocation:{coords:null},gpsSourceLocation:{latitude:45.7703307,longitude:4.880336},positionListener:{X:0,Y:0,Z:0},position:{X:0,Y:0,Z:0},orientationListenerRad:{forwardX:0,forwardY:0,forwardZ:1,upX:0,upY:1,upZ:0},orientationSourceRad:{X:0,Y:0,Z:-1},pannerSettings:{pannerModel:"HRTF",innerCone:360,outerCone:0,outerGain:0,distanceModel:"inverse",maxDistance:1e4,refDistance:1,rollOff:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:1},panner:null,bounds:{topBound:window.innerHeight/2,bottomBound:-window.innerHeight/2,rightBound:window.innerWidth/2,leftBound:-window.innerWidth/2,forwardBound:500,backwardBound:-500}}},methods:{error(){console.warn("ERROR("+err.code+"): "+err.message)},init(){console.log("init method"),console.log(this.getDistanceFromGPSinKm(45.7703307,4.880336,45.7867264,4.8726016)),this.listener.positionX?(this.listener.positionX.value=this.position.X,this.listener.positionY.value=this.position.Y,this.listener.positionZ.value=this.position.Z-12):this.listener.setPosition(this.position.X,this.position.Y,this.position.Z-12),this.listener.setOrientation(0,0,-1,0,1,0),console.log(this.listener),this.panner=new PannerNode(this.audioCtx,this.pannerSettings),console.log(this.panner),this.track=this.audioCtx.createMediaElementSource(this.$refs.audioPlayer);const o=this.audioCtx.createGain(),t=document.querySelector('[data-action="volume"]');t.addEventListener("input",(function(){o.gain.value=this.value}),!1),this.track.connect(o).connect(this.panner).connect(this.audioCtx.destination)},moveBoombox(o){const t=(this.bounds.rightBound-this.bounds.leftBound)/100,i=(this.bounds.topBound-this.bounds.bottomBound)/100,e=(this.bounds.forwardBound-this.bounds.backwardBound)/100;switch(o){case"left":this.panner.positionX.value>this.bounds.leftBound&&(this.panner.positionX.value-=t);break;case"up":this.panner.positionY.value<this.bounds.topBound&&(this.panner.positionY.value+=i),console.log(this.panner.positionY.value);break;case"right":this.panner.positionX.value<this.bounds.rightBound&&(this.panner.positionX.value+=t);break;case"down":this.panner.positionY.value>this.bounds.bottomBound&&(this.panner.positionY.value-=i);break;case"backward":this.panner.positionZ.value>this.bounds.backwardBound&&(this.panner.positionZ.value-=e);break;case"forward":this.panner.positionZ.value<this.bounds.forwardBound&&(this.panner.positionZ.value+=e);break}},updatePanner(o,t){switch(console.log("updatePanner"),console.log(this.position.X),console.log(o),console.log(t),o){case"X":this.panner.positionX.value=t;break;case"Y":this.panner.positionY.value=t;break;case"Z":this.panner.positionZ.value=t;break}console.log(this.panner),console.log(this.listener)},updateListener(o,t){switch(console.log("updateListener"),console.log(o),console.log(t),o){case"X":this.listener.positionX.value=t;break;case"Y":this.listener.positionY.value=t;break;case"Z":this.listener.positionZ.value=t;break}},async playMusic(){if(!this.audioCtx){const o=window.AudioContext||window.webkitAudioContext;console.log(this.listener),this.audioCtx=new o,this.listener=this.audioCtx.listener,this.init()}"running"===this.audioCtx.state?this.$refs.audioPlayer.paused?this.$refs.audioPlayer.play():this.$refs.audioPlayer.pause():console.error("audio context down"),"suspended"===this.audioCtx.state&&this.audioCtx.resume()},rotateListenerX(o){const t=Math.PI/10,i=this.orientationListenerRad.forwardY,e=this.orientationListenerRad.forwardZ;switch(o){case"clockwise":this.orientationListenerRad.forwardZ=e*Math.cos(t)+i*Math.sin(t),this.orientationListenerRad.forwardY=i*Math.cos(t)-e*Math.sin(t);break;case"anticlockwise":this.orientationListenerRad.forwardZ=e*Math.cos(t)-i*Math.sin(t),this.orientationListenerRad.forwardY=i*Math.cos(t)+e*Math.sin(t);break}this.listener.forwardY.value=this.orientationListenerRad.forwardY,this.listener.forwardZ.value=this.orientationListenerRad.forwardZ,console.log(this.listener)},rotateListenerY(o){const t=Math.PI/10,i=this.orientationListenerRad.forwardX,e=this.orientationListenerRad.forwardZ;switch(o){case"clockwise":this.orientationListenerRad.forwardX=i*Math.cos(t)+e*Math.sin(t),this.orientationListenerRad.forwardZ=e*Math.cos(t)-i*Math.sin(t);break;case"anticlockwise":this.orientationListenerRad.forwardX=i*Math.cos(t)-e*Math.sin(t),this.orientationListenerRad.forwardZ=e*Math.cos(t)+i*Math.sin(t);break}this.listener.forwardX.value=this.orientationListenerRad.forwardX,this.listener.forwardZ.value=this.orientationListenerRad.forwardZ,console.log(this.listener)},rotateListenerZ(o){const t=Math.PI/10,i=this.orientationListenerRad.forwardX,e=this.orientationListenerRad.forwardY;switch(o){case"clockwise":this.orientationListenerRad.forwardX=i*Math.cos(t)+e*Math.sin(t),this.orientationListenerRad.forwardY=e*Math.cos(t)-i*Math.sin(t);break;case"anticlockwise":this.orientationListenerRad.forwardX=i*Math.cos(t)-e*Math.sin(t),this.orientationListenerRad.forwardY=e*Math.cos(t)+i*Math.sin(t);break}this.listener.forwardX.value=this.orientationListenerRad.forwardX,this.listener.forwardY.value=this.orientationListenerRad.forwardY,console.log(this.listener)},rotateSourceX(o){const t=Math.PI/10,i=this.orientationSourceRad.Y,e=this.orientationSourceRad.Z;switch(o){case"clockwise":this.orientationSourceRad.Z=e*Math.cos(t)+i*Math.sin(t),this.orientationSourceRad.Y=i*Math.cos(t)-e*Math.sin(t);break;case"anticlockwise":this.orientationSourceRad.Z=e*Math.cos(t)-i*Math.sin(t),this.orientationSourceRad.Y=i*Math.cos(t)+e*Math.sin(t);break}this.panner.orientationY.value=this.orientationSourceRad.Y,this.panner.orientationZ.value=this.orientationSourceRad.Z,console.log(this.orientationSourceRad)},rotateSourceY(o){const t=Math.PI/10,i=this.orientationSourceRad.X,e=this.orientationSourceRad.Z;switch(o){case"clockwise":this.orientationSourceRad.X=i*Math.cos(t)+e*Math.sin(t),this.orientationSourceRad.Z=e*Math.cos(t)-i*Math.sin(t);break;case"anticlockwise":this.orientationSourceRad.X=i*Math.cos(t)-e*Math.sin(t),this.orientationSourceRad.Z=e*Math.cos(t)+i*Math.sin(t);break}this.panner.orientationZ.value=this.orientationSourceRad.Z,this.panner.orientationX.value=this.orientationSourceRad.X,console.log(this.orientationSourceRad)},rotateSourceZ(o){const t=Math.PI/10,i=this.orientationSourceRad.X,e=this.orientationSourceRad.Y;switch(o){case"clockwise":console.log("Spin Right"),this.orientationSourceRad.X=i*Math.cos(t)+e*Math.sin(t),this.orientationSourceRad.Y=e*Math.cos(t)-i*Math.sin(t);break;case"anticlockwise":this.orientationSourceRad.X=i*Math.cos(t)-e*Math.sin(t),this.orientationSourceRad.Y=e*Math.cos(t)+i*Math.sin(t);break}this.panner.orientationY.value=this.orientationSourceRad.Y,this.panner.orientationX.value=this.orientationSourceRad.X,console.log(this.orientationSourceRad)},getDistanceFromGPSinKm(o,t,i,e){var n=6371,a=this.deg2rad(i-o),s=this.deg2rad(e-t),r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(this.deg2rad(o))*Math.cos(this.deg2rad(i))*Math.sin(s/2)*Math.sin(s/2),l=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),c=n*l;return c},deg2rad(o){return o*(Math.PI/180)},async updateGPSListenerPosition(){return new Promise(((o,t)=>{navigator.geolocation.getCurrentPosition((t=>{console.log("Pos : "),console.log(t);var i={latitude:this.deg2rad(t.coords.latitude),longitude:this.deg2rad(t.coords.longitude)};this.gpsListenerLocation.coords=i,o(t)}),(o=>{t(o)}))}))},async updateCartesianListenerPosition(){var o=6371;await this.updateGPSListenerPosition();var t={latitude:this.gpsSourceLocation.latitude-this.gpsListenerLocation.coords.latitude,longitude:this.gpsSourceLocation.longitude-this.gpsListenerLocation.coords.longitude},i={X:o*(Math.cos(this.deg2rad(this.gpsSourceLocation.latitude))*Math.cos(this.deg2rad(this.gpsSourceLocation.longitude))-Math.cos(this.gpsListenerLocation.coords.latitude)*Math.cos(this.gpsListenerLocation.coords.longitude)),Y:o*(Math.cos(this.deg2rad(this.gpsSourceLocation.latitude))*Math.sin(this.deg2rad(this.gpsSourceLocation.longitude))-Math.cos(this.gpsListenerLocation.coords.latitude)*Math.sin(this.gpsListenerLocation.coords.longitude)),Z:o*(Math.sin(this.deg2rad(this.gpsSourceLocation.latitude))-Math.sin(this.gpsListenerLocation.coords.latitude))};console.log("Difference GPS : "),console.log(t),console.log("Difference Cartesian : "),console.log(i),this.positionListener.X=i.X,this.updateListener("X",this.positionListener.X),this.positionListener.Y=i.Y,this.updateListener("Y",this.positionListener.Y),this.positionListener.Z=i.Z,this.updateListener("Z",this.positionListener.Z),console.log("Source GPS : "),console.log(this.gpsSourceLocation),console.log("Listener GPS : "),console.log(this.gpsListenerLocation),console.log("Difference Cartesian"),console.log(i),console.log("Position Listener"),console.log(this.positionListener)}}};document.querySelector("audio"),document.querySelector(".tape-controls-play");var po=i(4260),wo=i(4379),go=i(8902),mo=i(7435),bo=i(8786),ko=i(7518),vo=i.n(ko);const Lo=(0,po.Z)(ho,[["render",uo]]),fo=Lo;vo()(ho,"components",{QPage:wo.Z,QSlider:go.Z,QBtn:mo.Z,QInput:bo.Z})}}]);