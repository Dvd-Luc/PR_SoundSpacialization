"use strict";(self["webpackChunkpr_spacialization"]=self["webpackChunkpr_spacialization"]||[]).push([[264],{607:(o,t,i)=>{i.d(t,{Z:()=>w});i(71);var e=i(3673),n=i(2323);const s={id:"app"},a=(0,e.Uk)(" Let us locate you for better results... "),r={key:0},l={key:1},c=(0,e._)("i",null,"Getting your location...",-1),u=[c],d={key:2};function h(o,t,i,c,h,p){return(0,e.wg)(),(0,e.iD)("div",s,[(0,e._)("p",null,[a,(0,e._)("button",{onClick:t[0]||(t[0]=(...o)=>p.locateMe&&p.locateMe(...o))},"Get location")]),o.errorStr?((0,e.wg)(),(0,e.iD)("div",r," Sorry, but the following error occurred: "+(0,n.zw)(o.errorStr),1)):(0,e.kq)("",!0),o.gettingLocation?((0,e.wg)(),(0,e.iD)("div",l,u)):(0,e.kq)("",!0),o.location?((0,e.wg)(),(0,e.iD)("div",d," Your location data is "+(0,n.zw)(o.location.coords.latitude)+", "+(0,n.zw)(o.location.coords.longitude),1)):(0,e.kq)("",!0)])}i(6701);const p={name:"Localisation",data:function(){return{location:null,orientation:null,gettingLocation:!1,errorStr:null}},mounted:()=>{console.log("huhuhuhu")},computed:{dispOrientation(){return this.orientation}},methods:{async getLocation(){return new Promise(((o,t)=>{"geolocation"in navigator||t(new Error("Geolocation is not available.")),navigator.geolocation.getCurrentPosition((t=>{o(t)}),(o=>{t(o)}))}))},async getOrientation(){if(!window.DeviceOrientationEvent)throw console.log("Orientation not available"),new Error("Orientation not available on this device");window.addEventListener("deviceorientation",(o=>{console.log("z : "+o.alpha+"\n x : "+o.beta+"\n y : "+o.gamma+"\n abs"+o.absolute),this.orientation=Math.random()}))},async locateMe(){this.gettingLocation=!0;try{this.gettingLocation=!1,this.location=await this.getLocation()}catch(o){this.gettingLocation=!1,this.errorStr=o.message}},async orientateMe(){try{this.orientation=await this.getOrientation(),console.log(this.orientation)}catch(o){this.errorStr=o.message}}}};var g=i(4260);const m=(0,g.Z)(p,[["render",h]]),w=m},8264:(o,t,i)=>{i.r(t),i.d(t,{default:()=>lo});var e=i(3673);const n={class:"boombox-body"},s={class:"bb-front"},a=(0,e._)("section",{class:"master-controls"},[(0,e._)("input",{type:"range",id:"volume",class:"control-volume",min:"0",max:"2",value:"1",list:"gain-vals",step:"0.01","data-action":"volume"}),(0,e._)("datalist",{id:"gain-vals"},[(0,e._)("option",{value:"0",label:"min"}),(0,e._)("option",{value:"2",label:"max"})]),(0,e._)("label",{for:"volume"},"VOL")],-1),r={class:"tape"},l={ref:"audioPlayer",src:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/858/outfoxing.mp3",crossorigin:"anonymous"},c=(0,e._)("span",null,"Play/Pause",-1),u=(0,e._)("div",{class:"bb-top"},null,-1),d=(0,e._)("div",{class:"bb-right"},null,-1),h=(0,e._)("div",{class:"bb-bottom"},null,-1),p=(0,e._)("div",{class:"bb-left"},null,-1),g=(0,e._)("div",{class:"bb-back"},null,-1),m=(0,e._)("div",{id:"show position","aria-labelledby":"move-boombox"},null,-1),w={id:"position-controls","aria-labelledby":"get-position-boombox"},b=(0,e._)("h3",{id:"get-position-boombox"},"Get Position",-1),v={class:"get-position_xy"},k={class:"row q-col-gutter-sm"},L={class:"column"},S={class:"column"},_={class:"column"},M={id:"move-listener",class:"row q-col-gutter-sm"},Z={class:"column"},f={class:"column"},Y={class:"column"},X={id:"move-controls","aria-labelledby":"move-boombox"},x=(0,e._)("h3",{id:"move-boombox"},"Move Boombox",-1),C={class:"row q-col-gutter-sm"},P={class:"column"},R=(0,e._)("span",null,"Left",-1),y=(0,e._)("span",null,"Right",-1),B={class:"column"},W=(0,e._)("span",null,"Up",-1),V=(0,e._)("span",null,"Down",-1),q={class:"column"},D=(0,e._)("span",null,"Backward",-1),G=(0,e._)("span",null,"Forward",-1),O={id:"rotate-source"},I=(0,e._)("h3",null,"Rotate Source",-1),U={class:"row q-col-gutter-sm"},z={class:"column"},E=(0,e._)("span",null,"Clockwise X",-1),A=(0,e._)("span",null,"Anticlockwise X",-1),F={class:"column"},Q=(0,e._)("span",null,"Clockwise Y",-1),$=(0,e._)("span",null,"Anticlockwise Y",-1),H={class:"column"},K=(0,e._)("span",null,"Clockwise Z",-1),N=(0,e._)("span",null,"Anticlockwise Z",-1);function j(o,t,i,j,T,J){const oo=(0,e.up)("q-btn"),to=(0,e.up)("q-input"),io=(0,e.up)("Localisation"),eo=(0,e.up)("q-page");return(0,e.wg)(),(0,e.j4)(eo,null,{default:(0,e.w5)((()=>[(0,e._)("div",n,[(0,e._)("div",s,[a,(0,e._)("section",r,[(0,e._)("audio",l,null,512),(0,e.Wm)(oo,{onClick:t[0]||(t[0]=o=>J.playMusic()),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[c])),_:1})])]),u,d,h,p,g]),m,(0,e._)("div",w,[b,(0,e._)("section",v,[(0,e._)("div",k,[(0,e._)("div",L,[(0,e.Wm)(to,{standout:"",modelValue:T.pannerSettings.positionX,"onUpdate:modelValue":t[1]||(t[1]=o=>T.pannerSettings.positionX=o),onChange:t[2]||(t[2]=o=>J.updatePanner("X",T.pannerSettings.positionX)),label:"Source X Position"},null,8,["modelValue"])]),(0,e._)("div",S,[(0,e.Wm)(to,{standout:"",modelValue:T.pannerSettings.positionY,"onUpdate:modelValue":t[3]||(t[3]=o=>T.pannerSettings.positionY=o),onChange:t[4]||(t[4]=o=>J.updatePanner("Y",T.pannerSettings.positionY)),label:"Source Y Position"},null,8,["modelValue"])]),(0,e._)("div",_,[(0,e.Wm)(to,{standout:"",modelValue:T.pannerSettings.positionZ,"onUpdate:modelValue":t[5]||(t[5]=o=>T.pannerSettings.positionZ=o),onChange:t[6]||(t[6]=o=>J.updatePanner("Z",T.pannerSettings.positionZ)),label:"Source Z Position"},null,8,["modelValue"])])]),(0,e._)("div",M,[(0,e._)("div",Z,[(0,e.Wm)(to,{standout:"",modelValue:T.positionListener.X,"onUpdate:modelValue":t[7]||(t[7]=o=>T.positionListener.X=o),onChange:t[8]||(t[8]=o=>J.updateListener("X",T.positionListener.X)),label:"Listener X Position"},null,8,["modelValue"])]),(0,e._)("div",f,[(0,e.Wm)(to,{standout:"",modelValue:T.positionListener.Y,"onUpdate:modelValue":t[9]||(t[9]=o=>T.positionListener.Y=o),onChange:t[10]||(t[10]=o=>J.updateListener("Y",T.positionListener.Y)),label:"Listener Y Position"},null,8,["modelValue"])]),(0,e._)("div",Y,[(0,e.Wm)(to,{standout:"",modelValue:T.positionListener.Z,"onUpdate:modelValue":t[11]||(t[11]=o=>T.positionListener.Z=o),onChange:t[12]||(t[12]=o=>J.updateListener("Z",T.positionListener.Z)),label:"Listener Z Position"},null,8,["modelValue"])])])])]),(0,e._)("div",X,[x,(0,e._)("div",C,[(0,e._)("div",P,[(0,e.Wm)(oo,{onClick:t[13]||(t[13]=o=>J.moveBoombox("left")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[R])),_:1}),(0,e.Wm)(oo,{onClick:t[14]||(t[14]=o=>J.moveBoombox("right")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[y])),_:1})]),(0,e._)("div",B,[(0,e.Wm)(oo,{onClick:t[15]||(t[15]=o=>J.moveBoombox("up")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[W])),_:1}),(0,e.Wm)(oo,{onClick:t[16]||(t[16]=o=>J.moveBoombox("down")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[V])),_:1})]),(0,e._)("div",q,[(0,e.Wm)(oo,{onClick:t[17]||(t[17]=o=>J.moveBoombox("backward")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[D])),_:1}),(0,e.Wm)(oo,{onClick:t[18]||(t[18]=o=>J.moveBoombox("forward")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[G])),_:1})])])]),(0,e._)("div",O,[I,(0,e._)("div",U,[(0,e._)("div",z,[(0,e.Wm)(oo,{onClick:t[19]||(t[19]=o=>J.rotateSourceX("clockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[E])),_:1}),(0,e.Wm)(oo,{onClick:t[20]||(t[20]=o=>J.rotateSourceX("anticlockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[A])),_:1})]),(0,e._)("div",F,[(0,e.Wm)(oo,{onClick:t[21]||(t[21]=o=>J.rotateSourceY("clockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[Q])),_:1}),(0,e.Wm)(oo,{onClick:t[22]||(t[22]=o=>J.rotateSourceY("anticlockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[$])),_:1})]),(0,e._)("div",H,[(0,e.Wm)(oo,{onClick:t[23]||(t[23]=o=>J.rotateSourceZ("clockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[K])),_:1}),(0,e.Wm)(oo,{onClick:t[24]||(t[24]=o=>J.rotateSourceX("anticlockwise")),color:"white","text-color":"black"},{default:(0,e.w5)((()=>[N])),_:1})])])]),(0,e.Wm)(io)])),_:1})}var T=i(607);const J={name:"Boombox",data(){return{localisationCtx:null,audioCtx:null,listener:null,track:null,gainNode:null,gpsListenerLocation:{coords:null},gpsSourceLocation:{latitude:45.7703307,longitude:4.880336},positionListener:{X:0,Y:0,Z:0},position:{X:0,Y:0,Z:0},orientationListenerRad:{forwardX:0,forwardY:0,forwardZ:1,upX:0,upY:1,upZ:0},orientationSourceRad:{X:0,Y:0,Z:-1},pannerSettings:{pannerModel:"HRTF",innerCone:360,outerCone:0,outerGain:0,distanceModel:"inverse",maxDistance:1e4,refDistance:1,rollOff:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:1},panner:null,bounds:{topBound:window.innerHeight/2,bottomBound:-window.innerHeight/2,rightBound:window.innerWidth/2,leftBound:-window.innerWidth/2,forwardBound:500,backwardBound:-500}}},components:{Localisation:T.Z},methods:{error(){console.warn("ERROR("+err.code+"): "+err.message)},init(){console.log("init method"),console.log(this.getDistanceFromGPSinKm(45.7703307,4.880336,45.7867264,4.8726016)),this.listener.positionX?(this.listener.positionX.value=this.position.X,this.listener.positionY.value=this.position.Y,this.listener.positionZ.value=this.position.Z-12):this.listener.setPosition(this.position.X,this.position.Y,this.position.Z-12),this.listener.setOrientation(0,0,-1,0,1,0),console.log(this.listener),this.panner=new PannerNode(this.audioCtx,this.pannerSettings),console.log(this.panner),this.track=this.audioCtx.createMediaElementSource(this.$refs.audioPlayer);const o=this.audioCtx.createGain(),t=document.querySelector('[data-action="volume"]');t.addEventListener("input",(function(){o.gain.value=this.value}),!1),this.track.connect(o).connect(this.panner).connect(this.audioCtx.destination)},moveBoombox(o){const t=(this.bounds.rightBound-this.bounds.leftBound)/100,i=(this.bounds.topBound-this.bounds.bottomBound)/100,e=(this.bounds.forwardBound-this.bounds.backwardBound)/100;switch(o){case"left":this.panner.positionX.value>this.bounds.leftBound&&(this.panner.positionX.value-=t);break;case"up":this.panner.positionY.value<this.bounds.topBound&&(this.panner.positionY.value+=i),console.log(this.panner.positionY.value);break;case"right":this.panner.positionX.value<this.bounds.rightBound&&(this.panner.positionX.value+=t);break;case"down":this.panner.positionY.value>this.bounds.bottomBound&&(this.panner.positionY.value-=i);break;case"backward":this.panner.positionZ.value>this.bounds.backwardBound&&(this.panner.positionZ.value-=e);break;case"forward":this.panner.positionZ.value<this.bounds.forwardBound&&(this.panner.positionZ.value+=e);break}},updatePanner(o,t){switch(console.log("updatePanner"),console.log(this.position.X),console.log(o),console.log(t),o){case"X":this.panner.positionX.value=t;break;case"Y":this.panner.positionY.value=t;break;case"Z":this.panner.positionZ.value=t;break}console.log(this.panner),console.log(this.listener)},updateListener(o,t){switch(console.log("updateListener"),console.log(o),console.log(t),o){case"X":this.listener.positionX.value=t;break;case"Y":this.listener.positionY.value=t;break;case"Z":this.listener.positionZ.value=t;break}},async playMusic(){if(!this.audioCtx){const o=window.AudioContext||window.webkitAudioContext;console.log(this.listener),this.audioCtx=new o,this.listener=this.audioCtx.listener,this.init()}"running"===this.audioCtx.state?this.$refs.audioPlayer.paused?this.$refs.audioPlayer.play():this.$refs.audioPlayer.pause():console.error("audio context down"),"suspended"===this.audioCtx.state&&this.audioCtx.resume()},rotateListenerX(o){const t=Math.PI/10,i=this.orientationListenerRad.Y,e=this.orientationListenerRad.Z;switch(o){case"clockwise":this.orientationListenerRad.Z=e*Math.cos(t)+i*Math.sin(t),this.orientationListenerRad.Y=i*Math.cos(t)-e*Math.sin(t);break;case"anticlockwise":this.orientationListenerRad.Z=e*Math.cos(t)-i*Math.sin(t),this.orientationListenerRad.Y=i*Math.cos(t)+e*Math.sin(t);break}this.listener.orientationY.value=this.orientationListenerRad.Y,this.listener.orientationZ.value=this.orientationListenerRad.Z,console.log(this.orientationListenerRad)},rotateListenerY(o){Math.PI;switch(o){case"clockwise":break;case"anticlockwise":break}},rotateListenerZ(o){Math.PI;switch(o){case"clockwise":break;case"anticlockwise":break}},rotateSourceX(o){const t=Math.PI/10,i=this.orientationSourceRad.Y,e=this.orientationSourceRad.Z;switch(o){case"clockwise":this.orientationSourceRad.Z=e*Math.cos(t)+i*Math.sin(t),this.orientationSourceRad.Y=i*Math.cos(t)-e*Math.sin(t);break;case"anticlockwise":this.orientationSourceRad.Z=e*Math.cos(t)-i*Math.sin(t),this.orientationSourceRad.Y=i*Math.cos(t)+e*Math.sin(t);break}this.panner.orientationY.value=this.orientationSourceRad.Y,this.panner.orientationZ.value=this.orientationSourceRad.Z,console.log(this.orientationSourceRad)},rotateSourceY(o){const t=Math.PI/10,i=this.orientationSourceRad.X,e=this.orientationSourceRad.Z;switch(o){case"clockwise":this.orientationSourceRad.X=i*Math.cos(t)+e*Math.sin(t),this.orientationSourceRad.Z=e*Math.cos(t)-i*Math.sin(t);break;case"anticlockwise":this.orientationSourceRad.X=i*Math.cos(t)-e*Math.sin(t),this.orientationSourceRad.Z=e*Math.cos(t)+i*Math.sin(t);break}this.panner.orientationZ.value=this.orientationSourceRad.Z,this.panner.orientationX.value=this.orientationSourceRad.X,console.log(this.orientationSourceRad)},rotateSourceZ(o){const t=Math.PI/10,i=this.orientationSourceRad.X,e=this.orientationSourceRad.Y;switch(o){case"clockwise":console.log("Spin Right"),this.orientationSourceRad.Y=e*Math.cos(t)+i*Math.sin(t),this.orientationSourceRad.X=i*Math.cos(t)-e*Math.sin(t);break;case"anticlockwise":this.orientationSourceRad.Y=e*Math.cos(t)-i*Math.sin(t),this.orientationSourceRad.X=i*Math.cos(t)+e*Math.sin(t);break}this.panner.orientationY.value=this.orientationSourceRad.Y,this.panner.orientationX.value=this.orientationSourceRad.X,console.log(this.orientationSourceRad)},getDistanceFromGPSinKm(o,t,i,e){var n=6371,s=this.deg2rad(i-o),a=this.deg2rad(e-t),r=Math.sin(s/2)*Math.sin(s/2)+Math.cos(this.deg2rad(o))*Math.cos(this.deg2rad(i))*Math.sin(a/2)*Math.sin(a/2),l=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),c=n*l;return c},deg2rad(o){return o*(Math.PI/180)},async updateGPSListenerPosition(){return new Promise(((o,t)=>{navigator.geolocation.getCurrentPosition((t=>{console.log("Pos : "),console.log(t);var i={latitude:this.deg2rad(t.coords.latitude),longitude:this.deg2rad(t.coords.longitude)};this.gpsListenerLocation.coords=i,o(t)}),(o=>{t(o)}))}))},async updateCartesianListenerPosition(){var o=6371;await this.updateGPSListenerPosition();var t={latitude:this.gpsSourceLocation.latitude-this.gpsListenerLocation.coords.latitude,longitude:this.gpsSourceLocation.longitude-this.gpsListenerLocation.coords.longitude},i={X:o*(Math.cos(this.deg2rad(this.gpsSourceLocation.latitude))*Math.cos(this.deg2rad(this.gpsSourceLocation.longitude))-Math.cos(this.gpsListenerLocation.coords.latitude)*Math.cos(this.gpsListenerLocation.coords.longitude)),Y:o*(Math.cos(this.deg2rad(this.gpsSourceLocation.latitude))*Math.sin(this.deg2rad(this.gpsSourceLocation.longitude))-Math.cos(this.gpsListenerLocation.coords.latitude)*Math.sin(this.gpsListenerLocation.coords.longitude)),Z:o*(Math.sin(this.deg2rad(this.gpsSourceLocation.latitude))-Math.sin(this.gpsListenerLocation.coords.latitude))};console.log("Difference GPS : "),console.log(t),console.log("Difference Cartesian : "),console.log(i),this.positionListener.X=i.X,this.updateListener("X",this.positionListener.X),this.positionListener.Y=i.Y,this.updateListener("Y",this.positionListener.Y),this.positionListener.Z=i.Z,this.updateListener("Z",this.positionListener.Z),console.log("Source GPS : "),console.log(this.gpsSourceLocation),console.log("Listener GPS : "),console.log(this.gpsListenerLocation),console.log("Difference Cartesian"),console.log(i),console.log("Position Listener"),console.log(this.positionListener)}}};document.querySelector("audio"),document.querySelector(".tape-controls-play");var oo=i(4260),to=i(4379),io=i(8902),eo=i(7435),no=i(8786),so=i(7518),ao=i.n(so);const ro=(0,oo.Z)(J,[["render",j]]),lo=ro;ao()(J,"components",{QPage:to.Z,QSlider:io.Z,QBtn:eo.Z,QInput:no.Z})}}]);