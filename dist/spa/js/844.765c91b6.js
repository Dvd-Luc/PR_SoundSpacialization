"use strict";(self["webpackChunkpr_spacialization"]=self["webpackChunkpr_spacialization"]||[]).push([[844],{9844:(t,e,o)=>{o.r(e),o.d(e,{default:()=>Vt});var i=o(3673);const n={class:"boombox-body"},s={class:"bb-front"},a=(0,i._)("section",{class:"master-controls"},[(0,i._)("input",{type:"range",id:"volume",class:"control-volume",min:"0",max:"2",value:"1",list:"gain-vals",step:"0.01","data-action":"volume"}),(0,i._)("datalist",{id:"gain-vals"},[(0,i._)("option",{value:"0",label:"min"}),(0,i._)("option",{value:"2",label:"max"})]),(0,i._)("label",{for:"volume"},"VOL")],-1),r={class:"tape"},l={ref:"audioPlayer",src:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/858/outfoxing.mp3",crossorigin:"anonymous"},c=(0,i._)("span",null,"Pause",-1),d=(0,i._)("span",null,"Play",-1),u={class:"source-parameters"},h=(0,i._)("div",{id:"show position","aria-labelledby":"move-boombox"},null,-1),p={id:"position-controls","aria-labelledby":"get-position-boombox"},w=(0,i._)("h3",{id:"get-position-boombox"},"Get Position",-1),m={class:"get-position_xy"},k={class:"row q-col-gutter-sm"},g={class:"column"},_={class:"column"},b={class:"column"},v={id:"move-listener",class:"row q-col-gutter-sm"},L={class:"column"},f={class:"column"},S={class:"column"},M={id:"move-controls","aria-labelledby":"move-boombox"},x={id:"move-source"},R=(0,i._)("h3",{id:"move-boombox"},"Move Boombox",-1),Z={class:"row q-col-gutter-sm"},X={class:"column"},Y=(0,i._)("span",null,"Left",-1),C=(0,i._)("span",null,"Right",-1),P={class:"column"},W=(0,i._)("span",null,"Up",-1),y=(0,i._)("span",null,"Down",-1),F={class:"column"},D=(0,i._)("span",null,"Backward",-1),V=(0,i._)("span",null,"Forward",-1),B={id:"move-listener"},q=(0,i._)("h3",{id:"move-listener"},"Move Listener",-1),U={class:"row q-col-gutter-sm"},H={class:"column"},O=(0,i._)("span",null,"Left",-1),T=(0,i._)("span",null,"Right",-1),A={class:"column"},I=(0,i._)("span",null,"Up",-1),Q=(0,i._)("span",null,"Down",-1),$={class:"column"},j=(0,i._)("span",null,"Backward",-1),z=(0,i._)("span",null,"Forward",-1),E={class:"row q-col-gutter-sm"},G={id:"rotate-source"},N=(0,i._)("h3",null,"Rotate Source",-1),J={class:"row q-col-gutter-sm"},K={class:"column"},tt=(0,i._)("span",null,"Clockwise X",-1),et=(0,i._)("span",null,"Anticlockwise X",-1),ot={class:"column"},it=(0,i._)("span",null,"Clockwise Y",-1),nt=(0,i._)("span",null,"Anticlockwise Y",-1),st={class:"column"},at=(0,i._)("span",null,"Clockwise Z",-1),rt=(0,i._)("span",null,"Anticlockwise Z",-1),lt={id:"rotate-Listener"},ct=(0,i._)("h3",null,"Rotate Listener",-1),dt={class:"row q-col-gutter-sm"},ut={class:"column"},ht=(0,i._)("span",null,"Clockwise X",-1),pt=(0,i._)("span",null,"Anticlockwise X",-1),wt={class:"column"},mt=(0,i._)("span",null,"Clockwise Y",-1),kt=(0,i._)("span",null,"Anticlockwise Y",-1),gt={class:"column"},_t=(0,i._)("span",null,"Clockwise Z",-1),bt=(0,i._)("span",null,"Anticlockwise Z",-1);function vt(t,e,o,vt,Lt,ft){const St=(0,i.up)("q-btn"),Mt=(0,i.up)("SourceParameters"),xt=(0,i.up)("q-input"),Rt=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(Rt,null,{default:(0,i.w5)((()=>[(0,i._)("div",n,[(0,i._)("div",s,[a,(0,i._)("section",r,[(0,i._)("audio",l,null,512),Lt.audioPlaying?((0,i.wg)(),(0,i.j4)(St,{key:0,onClick:e[0]||(e[0]=t=>ft.playMusic()),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[c])),_:1})):(0,i.kq)("",!0),Lt.audioPlaying?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(St,{key:1,onClick:e[1]||(e[1]=t=>ft.playMusic()),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[d])),_:1}))])])]),(0,i._)("div",u,[(0,i.Wm)(Mt,{onUpdateHRTFDistanceModel:ft.onUpdateChangeHRTFDistanceModel},null,8,["onUpdateHRTFDistanceModel"])]),h,(0,i._)("div",p,[w,(0,i._)("section",m,[(0,i._)("div",k,[(0,i._)("div",g,[(0,i.Wm)(xt,{standout:"",modelValue:Lt.pannerSettings.positionX,"onUpdate:modelValue":e[2]||(e[2]=t=>Lt.pannerSettings.positionX=t),onChange:e[3]||(e[3]=t=>ft.updatePanner("X",Lt.pannerSettings.positionX)),label:"Source X Position"},null,8,["modelValue"])]),(0,i._)("div",_,[(0,i.Wm)(xt,{standout:"",modelValue:Lt.pannerSettings.positionY,"onUpdate:modelValue":e[4]||(e[4]=t=>Lt.pannerSettings.positionY=t),onChange:e[5]||(e[5]=t=>ft.updatePanner("Y",Lt.pannerSettings.positionY)),label:"Source Y Position"},null,8,["modelValue"])]),(0,i._)("div",b,[(0,i.Wm)(xt,{standout:"",modelValue:Lt.pannerSettings.positionZ,"onUpdate:modelValue":e[6]||(e[6]=t=>Lt.pannerSettings.positionZ=t),onChange:e[7]||(e[7]=t=>ft.updatePanner("Z",Lt.pannerSettings.positionZ)),label:"Source Z Position"},null,8,["modelValue"])])]),(0,i._)("div",v,[(0,i._)("div",L,[(0,i.Wm)(xt,{standout:"",modelValue:Lt.positionListener.X,"onUpdate:modelValue":e[8]||(e[8]=t=>Lt.positionListener.X=t),onChange:e[9]||(e[9]=t=>ft.updateListener("X",Lt.positionListener.X)),label:"Listener X Position"},null,8,["modelValue"])]),(0,i._)("div",f,[(0,i.Wm)(xt,{standout:"",modelValue:Lt.positionListener.Y,"onUpdate:modelValue":e[10]||(e[10]=t=>Lt.positionListener.Y=t),onChange:e[11]||(e[11]=t=>ft.updateListener("Y",Lt.positionListener.Y)),label:"Listener Y Position"},null,8,["modelValue"])]),(0,i._)("div",S,[(0,i.Wm)(xt,{standout:"",modelValue:Lt.positionListener.Z,"onUpdate:modelValue":e[12]||(e[12]=t=>Lt.positionListener.Z=t),onChange:e[13]||(e[13]=t=>ft.updateListener("Z",Lt.positionListener.Z)),label:"Listener Z Position"},null,8,["modelValue"])])])])]),(0,i._)("div",M,[(0,i._)("div",x,[R,(0,i._)("div",Z,[(0,i._)("div",X,[(0,i.Wm)(St,{onClick:e[14]||(e[14]=t=>ft.moveBoombox("left")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[Y])),_:1}),(0,i.Wm)(St,{onClick:e[15]||(e[15]=t=>ft.moveBoombox("right")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[C])),_:1})]),(0,i._)("div",P,[(0,i.Wm)(St,{onClick:e[16]||(e[16]=t=>ft.moveBoombox("up")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[W])),_:1}),(0,i.Wm)(St,{onClick:e[17]||(e[17]=t=>ft.moveBoombox("down")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[y])),_:1})]),(0,i._)("div",F,[(0,i.Wm)(St,{onClick:e[18]||(e[18]=t=>ft.moveBoombox("backward")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[D])),_:1}),(0,i.Wm)(St,{onClick:e[19]||(e[19]=t=>ft.moveBoombox("forward")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[V])),_:1})])])]),(0,i._)("div",B,[q,(0,i._)("div",U,[(0,i._)("div",H,[(0,i.Wm)(St,{onClick:e[20]||(e[20]=t=>ft.moveListener("left")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[O])),_:1}),(0,i.Wm)(St,{onClick:e[21]||(e[21]=t=>ft.moveListener("right")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[T])),_:1})]),(0,i._)("div",A,[(0,i.Wm)(St,{onClick:e[22]||(e[22]=t=>ft.moveListener("up")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[I])),_:1}),(0,i.Wm)(St,{onClick:e[23]||(e[23]=t=>ft.moveListener("down")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[Q])),_:1})]),(0,i._)("div",$,[(0,i.Wm)(St,{onClick:e[24]||(e[24]=t=>ft.moveListener("backward")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[j])),_:1}),(0,i.Wm)(St,{onClick:e[25]||(e[25]=t=>ft.moveListener("forward")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[z])),_:1})])])])]),(0,i._)("div",E,[(0,i._)("div",G,[N,(0,i._)("div",J,[(0,i._)("div",K,[(0,i.Wm)(St,{onClick:e[26]||(e[26]=t=>ft.rotateSourceX("clockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[tt])),_:1}),(0,i.Wm)(St,{onClick:e[27]||(e[27]=t=>ft.rotateSourceX("anticlockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[et])),_:1})]),(0,i._)("div",ot,[(0,i.Wm)(St,{onClick:e[28]||(e[28]=t=>ft.rotateSourceY("clockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[it])),_:1}),(0,i.Wm)(St,{onClick:e[29]||(e[29]=t=>ft.rotateSourceY("anticlockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[nt])),_:1})]),(0,i._)("div",st,[(0,i.Wm)(St,{onClick:e[30]||(e[30]=t=>ft.rotateSourceZ("clockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[at])),_:1}),(0,i.Wm)(St,{onClick:e[31]||(e[31]=t=>ft.rotateSourceX("anticlockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[rt])),_:1})])])]),(0,i._)("div",lt,[ct,(0,i._)("div",dt,[(0,i._)("div",ut,[(0,i.Wm)(St,{onClick:e[32]||(e[32]=t=>ft.rotateListenerX("clockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[ht])),_:1}),(0,i.Wm)(St,{onClick:e[33]||(e[33]=t=>ft.rotateListenerX("anticlockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[pt])),_:1})]),(0,i._)("div",wt,[(0,i.Wm)(St,{onClick:e[34]||(e[34]=t=>ft.rotateListenerY("clockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[mt])),_:1}),(0,i.Wm)(St,{onClick:e[35]||(e[35]=t=>ft.rotateListenerY("anticlockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[kt])),_:1})]),(0,i._)("div",gt,[(0,i.Wm)(St,{onClick:e[36]||(e[36]=t=>ft.rotateListenerZ("clockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[_t])),_:1}),(0,i.Wm)(St,{onClick:e[37]||(e[37]=t=>ft.rotateListenerZ("anticlockwise")),color:"white","text-color":"black"},{default:(0,i.w5)((()=>[bt])),_:1})])])])])])),_:1})}const Lt={class:"Source parameters"};function ft(t,e,o,n,s,a){const r=(0,i.up)("q-select");return(0,i.wg)(),(0,i.iD)("div",Lt,[(0,i.Wm)(r,{standout:"",modelValue:s.selectedOption,"onUpdate:modelValue":[e[0]||(e[0]=t=>s.selectedOption=t),e[1]||(e[1]=e=>t.$emit("updateHRTFDistanceModel",s.selectedOption))],options:s.HRTFOptions,label:"HRTF Distance Model"},null,8,["modelValue","options"])])}const St={name:"SourceParameters",data(){return{HRTFOptions:["linear","inverse","exponential"],selectedOption:null}}};var Mt=o(4260),xt=o(1002),Rt=o(7518),Zt=o.n(Rt);const Xt=(0,Mt.Z)(St,[["render",ft]]),Yt=Xt;Zt()(St,"components",{QSelect:xt.Z});const Ct={name:"Boombox",data(){return{localisationCtx:null,audioCtx:null,audioPlaying:!1,listener:null,track:null,gainNode:null,positionListener:{X:0,Y:0,Z:0},orientationListenerRad:{forwardX:0,forwardY:0,forwardZ:1,upX:0,upY:1,upZ:0},orientationSourceRad:{X:0,Y:0,Z:-1},pannerSettings:{pannerModel:"HRTF",innerCone:360,outerCone:0,outerGain:0,distanceModel:"linear",maxDistance:100,refDistance:1,rollOff:1,positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:1},panner:null,bounds:{topBound:window.innerHeight/2,bottomBound:-window.innerHeight/2,rightBound:window.innerWidth/2,leftBound:-window.innerWidth/2,forwardBound:500,backwardBound:-500}}},components:{SourceParameters:Yt},methods:{onUpdateChangeHRTFDistanceModel(t){this.pannerSettings.distanceModel=t,this.panner.distanceModel=t,console.log(this.panner)},error(){console.warn("ERROR("+err.code+"): "+err.message)},init(){console.log("init method"),this.listener.positionX?(this.listener.positionX.value=this.positionListener.X,this.listener.positionY.value=this.positionListener.Y,this.listener.positionZ.value=this.positionListener.Z):(console.log("else set Pos"),this.listener.setPosition(this.positionListener.X,this.positionListener.Y,this.positionListener.Z)),this.listener.setOrientation(0,0,-1,0,1,0),console.log(this.listener),this.panner=new PannerNode(this.audioCtx,this.pannerSettings),console.log(this.panner),this.track=this.audioCtx.createMediaElementSource(this.$refs.audioPlayer);const t=this.audioCtx.createGain(),e=document.querySelector('[data-action="volume"]');e.addEventListener("input",(function(){t.gain.value=this.value}),!1),this.track.connect(t).connect(this.panner).connect(this.audioCtx.destination)},moveBoombox(t){const e=this.pannerSettings.maxDistance/100;let o={...this.pannerSettings};switch(t){case"left":this.pannerSettings.positionX=parseFloat(this.pannerSettings.positionX)-e;break;case"up":this.pannerSettings.positionY=parseFloat(this.pannerSettings.positionY)+e;break;case"right":this.pannerSettings.positionX=parseFloat(this.pannerSettings.positionX)+e;break;case"down":this.pannerSettings.positionY=parseFloat(this.pannerSettings.positionY)-e;break;case"backward":this.pannerSettings.positionZ=parseFloat(this.pannerSettings.positionZ)-e;break;case"forward":this.pannerSettings.positionZ=parseFloat(this.pannerSettings.positionZ)+e;break}this.getDistanceSourceListener()>this.pannerSettings.maxDistance?(console.log("Max Dist exceeded"),this.pannerSettings=o):this.updatePanner()},moveListener(t){const e=this.pannerSettings.maxDistance/100;let o={...this.positionListener};switch(t){case"left":this.positionListener.X=parseFloat(this.positionListener.X)-e;break;case"up":this.positionListener.Y=parseFloat(this.positionListener.Y)+e;break;case"right":this.positionListener.X=parseFloat(this.positionListener.X)+e;break;case"down":this.positionListener.Y=parseFloat(this.positionListener.Y)-e;break;case"backward":this.positionListener.Z=parseFloat(this.positionListener.Z)-e;break;case"forward":this.positionListener.Z=parseFloat(this.positionListener.Z)+e;break}this.getDistanceSourceListener()>this.pannerSettings.maxDistance?(console.log("Max Dist exceeded"),this.positionListener=o):this.updateListener()},getDistanceSourceListener(t=0,e=0,o=0){var i=Math.sqrt(Math.pow(this.pannerSettings.positionX-this.positionListener.X+t,2)+Math.pow(this.pannerSettings.positionY-this.positionListener.Y+e,2)+Math.pow(this.pannerSettings.positionZ-this.positionListener.Z+o,2));return i>this.pannerSettings.maxDistance&&console.log("Max Distance exceeded"),i},updatePanner(){console.log("updatePanner"),this.panner.positionX.value=this.pannerSettings.positionX,this.panner.positionY.value=this.pannerSettings.positionY,this.panner.positionZ.value=this.pannerSettings.positionZ},updateListener(){console.log("updateListener"),this.listener.positionX.value=this.positionListener.X,this.listener.positionY.value=this.positionListener.Y,this.listener.positionZ.value=this.positionListener.Z},async playMusic(){if(!this.audioCtx){const t=window.AudioContext||window.webkitAudioContext;this.audioCtx=new t,this.listener=this.audioCtx.listener,this.init()}"running"===this.audioCtx.state?this.$refs.audioPlayer.paused?(this.$refs.audioPlayer.play(),this.audioPlaying=!0):(this.$refs.audioPlayer.pause(),this.audioPlaying=!1):console.error("audio context down"),"suspended"===this.audioCtx.state&&this.audioCtx.resume()},rotateListenerX(t){const e=Math.PI/10,o=this.orientationListenerRad.forwardY,i=this.orientationListenerRad.forwardZ;switch(t){case"clockwise":this.orientationListenerRad.forwardZ=i*Math.cos(e)+o*Math.sin(e),this.orientationListenerRad.forwardY=o*Math.cos(e)-i*Math.sin(e);break;case"anticlockwise":this.orientationListenerRad.forwardZ=i*Math.cos(e)-o*Math.sin(e),this.orientationListenerRad.forwardY=o*Math.cos(e)+i*Math.sin(e);break}this.listener.forwardY.value=this.orientationListenerRad.forwardY,this.listener.forwardZ.value=this.orientationListenerRad.forwardZ,console.log(this.listener)},rotateListenerY(t){const e=Math.PI/10,o=this.orientationListenerRad.forwardX,i=this.orientationListenerRad.forwardZ;switch(t){case"clockwise":this.orientationListenerRad.forwardX=o*Math.cos(e)+i*Math.sin(e),this.orientationListenerRad.forwardZ=i*Math.cos(e)-o*Math.sin(e);break;case"anticlockwise":this.orientationListenerRad.forwardX=o*Math.cos(e)-i*Math.sin(e),this.orientationListenerRad.forwardZ=i*Math.cos(e)+o*Math.sin(e);break}this.listener.forwardX.value=this.orientationListenerRad.forwardX,this.listener.forwardZ.value=this.orientationListenerRad.forwardZ,console.log(this.listener)},rotateListenerZ(t){const e=Math.PI/10,o=this.orientationListenerRad.forwardX,i=this.orientationListenerRad.forwardY;switch(t){case"clockwise":this.orientationListenerRad.forwardX=o*Math.cos(e)+i*Math.sin(e),this.orientationListenerRad.forwardY=i*Math.cos(e)-o*Math.sin(e);break;case"anticlockwise":this.orientationListenerRad.forwardX=o*Math.cos(e)-i*Math.sin(e),this.orientationListenerRad.forwardY=i*Math.cos(e)+o*Math.sin(e);break}this.listener.forwardX.value=this.orientationListenerRad.forwardX,this.listener.forwardY.value=this.orientationListenerRad.forwardY,console.log(this.listener)},rotateSourceX(t){const e=Math.PI/10,o=this.orientationSourceRad.Y,i=this.orientationSourceRad.Z;switch(t){case"clockwise":this.orientationSourceRad.Z=i*Math.cos(e)+o*Math.sin(e),this.orientationSourceRad.Y=o*Math.cos(e)-i*Math.sin(e);break;case"anticlockwise":this.orientationSourceRad.Z=i*Math.cos(e)-o*Math.sin(e),this.orientationSourceRad.Y=o*Math.cos(e)+i*Math.sin(e);break}this.panner.orientationY.value=this.orientationSourceRad.Y,this.panner.orientationZ.value=this.orientationSourceRad.Z,console.log(this.orientationSourceRad)},rotateSourceY(t){const e=Math.PI/10,o=this.orientationSourceRad.X,i=this.orientationSourceRad.Z;switch(t){case"clockwise":this.orientationSourceRad.X=o*Math.cos(e)+i*Math.sin(e),this.orientationSourceRad.Z=i*Math.cos(e)-o*Math.sin(e);break;case"anticlockwise":this.orientationSourceRad.X=o*Math.cos(e)-i*Math.sin(e),this.orientationSourceRad.Z=i*Math.cos(e)+o*Math.sin(e);break}this.panner.orientationZ.value=this.orientationSourceRad.Z,this.panner.orientationX.value=this.orientationSourceRad.X,console.log(this.orientationSourceRad)},rotateSourceZ(t){const e=Math.PI/10,o=this.orientationSourceRad.X,i=this.orientationSourceRad.Y;switch(t){case"clockwise":console.log("Spin Right"),this.orientationSourceRad.X=o*Math.cos(e)+i*Math.sin(e),this.orientationSourceRad.Y=i*Math.cos(e)-o*Math.sin(e);break;case"anticlockwise":this.orientationSourceRad.X=o*Math.cos(e)-i*Math.sin(e),this.orientationSourceRad.Y=i*Math.cos(e)+o*Math.sin(e);break}this.panner.orientationY.value=this.orientationSourceRad.Y,this.panner.orientationX.value=this.orientationSourceRad.X,console.log(this.orientationSourceRad)},deg2rad(t){return t*(Math.PI/180)}}};var Pt=o(4379),Wt=o(4015),yt=o(4607),Ft=o(4842);const Dt=(0,Mt.Z)(Ct,[["render",vt]]),Vt=Dt;Zt()(Ct,"components",{QPage:Pt.Z,QSlider:Wt.Z,QBtn:yt.Z,QInput:Ft.Z})}}]);